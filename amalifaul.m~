function amalifaul(VonDat, BisDat)

% function to call Amali Processing (2nd step)
%
% 05/2020
% wertet alle Lidardaten von VonDat bis BisDat aus
%
% VonDat ='170523'; BisDat='170625';     oder '190319' '190408'
% Format jjmmdd as string
% 
% 




addpath('/atm_meas/polar_5_6/amali/processing/nadir/cloud/Amali_subroutines');  


campaign = 'AFLUX';          %'ACLOUD'

Speichernamepraefix = 'Version6Flux_';            

% reference Value for clean air beneath aircraft. 
% KARL are average values from Ny-Alesund
BSR532soll = 'KARL'; %1.3;

% ?????
BSRAtFit532start = 1.4;


%formatting strings to fit amali_eval_Wolke
Starttag=str2num(VonDat(5:6));
Startmonat=str2num(VonDat(3:4));
Startjahr=2000+str2num(VonDat(1:2));
NStart=datenum(Startjahr,Startmonat,Starttag);

Endtag=str2num(BisDat(5:6));
Endmonat=str2num(BisDat(3:4));
Endjahr=2000+str2num(BisDat(1:2));
NEnd=datenum(Endjahr,Endmonat,Endtag);

% ??????????????????? is this necessary, can this be removed?
%are we correcting for Amali overlap? I thought we didn't
% UeberlFile= '/home/critter/matlab2/mein/matlab/ueberlappwerte2013_iris4_zpos3';

for j=NStart:NEnd
   tmp = datestr(j); 
   tag = tmp(1:2);
   jahr= tmp(end-1:end);
   if tmp(4:6) =='Jan', monat='01';  kmonat='1'; end
   if tmp(4:6) =='Feb', monat='02';  kmonat='2'; end
   if tmp(4:6) =='Mar', monat='03';  kmonat='3'; end
   if tmp(4:6) =='Apr', monat='04';  kmonat='4'; end
   if tmp(4:6) =='May', monat='05';  kmonat='5'; end
   if tmp(4:6) =='Jun', monat='06';  kmonat='6'; end
   if tmp(4:6) =='Jul', monat='07';  kmonat='7'; end
   if tmp(4:6) =='Aug', monat='08';  kmonat='8'; end
   if tmp(4:6) =='Sep', monat='09';  kmonat='9'; end
   if tmp(4:6) =='Oct', monat='10';  kmonat='a'; end
   if tmp(4:6) =='Nov', monat='11';  kmonat='b'; end
   if tmp(4:6) =='Dec', monat='12';  kmonat='c'; end
   xdatum=[jahr monat tag]; 
   ydatum=[jahr kmonat tag]; 
   
   
   % calling function

   
   disp([upper(mfilename) ': Starting Data processing ...']);
   disp(['...of ', xdatum])
   %ok = amali_eval_ACLOUD(xdatum, campaign, Speichernamepraefix, BSR532soll,BSRAtFit532start);
   %Warum ist campaign kein inp
   ok = amali_eval_Wolke(xdatum, 1, Speichernamepraefix, BSR532soll,BSRAtFit532start);
   
   disp([upper(mfilename) '::::::::::: Done ::::::::::']);
   disp('  ');
    

end




disp([upper(mfilename) ': Das war es dann!!!']);
